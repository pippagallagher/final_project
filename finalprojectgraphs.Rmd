---
title: "Exploring_pippa"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(gt)
library(plotly)
library(patchwork)
sleep<-read.csv("SleepInMammals.csv")
```

```{r}
sleep
```


```{r}
sleep %>% 
  select(!Gestation.time..days.:Overall.danger.index) %>% 
  arrange(desc(Body.Weight..kg.)) %>% 
gt(rowname_col = "row",
   groupname_col = "group") %>% 
  tab_header(
    title = md("**Sleep Patterns in Mammals**")) %>% 
  tab_footnote(
    footnote = "Weight in kilograms", 
    locations = cells_column_labels(
      columns = 2)) %>% 
  tab_footnote(
    footnote = "Weight in grams",
    locations = cells_column_labels(
      columns = 3)) %>%
  tab_footnote(
    footnote = "Non-dreaming hours per day",
    locations = cells_column_labels(
      columns = 4)) %>%
  tab_footnote(
    footnote = "Dreaming hours per day",
    locations = cells_column_labels(
      columns = 5)) %>% 
  cols_label(
    Species.of.animal="Species",
    Body.Weight..kg.="Body Weight",
    Brain.Weight..g. ="Brain Weight",
    Slow.wave.sleep..hrs.day. = "Slow Wave Sleep",
    Paradoxical.sleep..hrs.day. = "Paradoxical Sleep",
    Total.sleep..hrs.day.	= "Total Sleep",
    Maximum.life.span..years. ="Maximum Life Span (yrs)")
```

```{r}
sleep_graph<-sleep %>% 
  mutate(body_wtlbs = Body.Weight..kg.*2.20462) %>%  
  arrange(desc(body_wtlbs)) %>% 
  head(25) %>% 
  ggplot(aes(
    y = body_wtlbs, 
    x = Total.sleep..hrs.day.,
    size = body_wtlbs,
    alpha = .5,
    color= Species.of.animal))+
  geom_point() +
  labs(title = "Total hours per day mammals of different weight (lbs) sleep",
       x = "",
       y = "") +
  theme(plot.title.position = "plot",
        legend.position = "None")

ggplotly(sleep_graph) %>% 
  hide_legend()
```

```{r}
sleep %>% 
    ggplot(aes(x = Overall.danger.index,
               y = fct_reorder(Species.of.animal,
                               Overall.danger.index,
                               .desc = FALSE),
               fill = Overall.danger.index)) +
    geom_col() +
    labs(title = "Overall danger index of attacks from other animals for mammals",
         x = "",
         y = "") +
    theme(legend.position = "None",
          plot.title.position = "plot")
```

```{r}
G0 <-
sleep %>% 
  mutate(percent_dreaming =(Paradoxical.sleep..hrs.day./Total.sleep..hrs.day.) * 100) %>% 
  ggplot() +
  geom_col(aes(x = percent_dreaming, y = Species.of.animal, fill = Total.sleep..hrs.day.)) +
  labs(title = "How Much do Mammals Dream",
       y = "",
       x = "Percentage of Hours Dreaming") +
  scale_x_continuous(expand = c(0,0))
G0

```

```{r}
G1 <-
  sleep %>% 
  select(Species.of.animal, Slow.wave.sleep..hrs.day.,Sleep.exposure.index) %>% 
  ggplot() +
  geom_col(aes(y = Slow.wave.sleep..hrs.day., 
               x = fct_reorder(Species.of.animal,Slow.wave.sleep..hrs.day.,median),
               fill = Sleep.exposure.index)) +
  geom_text(aes(y = Slow.wave.sleep..hrs.day. + 5, x=fct_reorder(Species.of.animal,Slow.wave.sleep..hrs.day.,median), label= Species.of.animal), color="white", fontface="bold",alpha=0.6, size=2.5, inherit.aes = FALSE ) +
  scale_color_viridis_c(option = "magma") +
  labs(title = "Sleep Breakdown",
       y = "",
       x = "",
       fill = "Sleep Exposure Index") +
  coord_polar(start = 0) +
  ylim(-3,23) +
   theme(
    axis.text = element_blank(),
    panel.grid = element_blank(),
    plot.background = element_rect(fill = "black"),
    panel.background = element_rect(fill = "black"),
    legend.background = element_rect(fill = "black"),
    plot.title = element_text(color = "white"),
    legend.text = element_text(color = "white"),
    legend.title = element_text(color = "white")) 
  
G1
```


```{r}
G2 <-
  sleep %>% 
  select(Species.of.animal,Paradoxical.sleep..hrs.day. ,Sleep.exposure.index) %>% 
  ggplot() +
  geom_col(aes(y = Paradoxical.sleep..hrs.day., 
               x = fct_reorder(Species.of.animal,Paradoxical.sleep..hrs.day.,median),
               fill = Sleep.exposure.index)) +
  geom_text(aes(y = Paradoxical.sleep..hrs.day. + 3, x=fct_reorder(Species.of.animal,Paradoxical.sleep..hrs.day.,median), label= Species.of.animal), color="white", fontface="bold",alpha=0.6, size=2.5, inherit.aes = FALSE ) +
  scale_color_viridis_c(option = "magma") +
  labs(title = "Sleep Breakdown",
       y = "",
       x = "",
       fill = "Sleep Exposure Index") +
  coord_polar(start = 0) +
  ylim(-1,10) +
   theme(
    axis.text = element_blank(),
    panel.grid = element_blank(),
    plot.background = element_rect(fill = "black"),
    panel.background = element_rect(fill = "black"),
    legend.background = element_rect(fill = "black"),
    legend.position = "none",
    plot.title = element_text(color = "white"),
    legend.text = element_text(color = "white"),
    legend.title = element_text(color = "white")) 

G2
```
```{r}
sleep %>% 
  ggplot() +
  geom_violin(aes(x = Overall.danger.index,
                  y= Maximum.life.span..years.),
                  fill = "violet",
                  color = "purple") +
  theme(
    plot.background = element_rect("black"),
    panel.background = element_rect("black"),
    plot.title = element_text(color = "purple"),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    legend.position = "none"
  ) +
  labs(x = "",
       y = "",
       title = "Maximum Life Span and Danger Index")
  
```





